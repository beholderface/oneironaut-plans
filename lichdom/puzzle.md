Whenever you, as a hex lich, take more than a few points of damage in one hit (overcast damage always triggers this, regardless of magnitude, and cannot be halved by solving the puzzle), you are presented with a sort of puzzle. The puzzle is presented as a vector, and you solve it by designing a hex that interprets that data into instructions on what iota you need to produce (it will never ask for iotas that cannot always be obtained with only zero-media patterns, such as gates or references to non-caster entities). You load the solver hex into something ahead of time, and it would be evaluated whenever the puzzle is triggered. If it produces the wrong iota or mishaps, there is a chance to die immediately, proportional (logarithmically) to the triggering damage after armor calculations. If it gets it right, the damage is halved, and if the damage is attributable to a mob or player they take some damage (or some of their media is lost if they have any in their inventory).

The puzzle cannot be triggered more than once per second, and any hits that would otherwise trigger it have their damage halved (but there is no backlash on the attacker).

The solver hex cannot consume any media, so that it can't be used as hex thorns.

The vector is generated randomly based on a set of rules, and those rules are also what your hex must use to solve the puzzle. These rules are cryptically explained in notes found in certain loot chests (one rule per note, probably with a system similar to base hex lore notes where you can't get duplicates), and there are also a bunch of input-output pairs in the book to make it possible to reverse-engineer them.
